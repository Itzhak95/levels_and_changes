# INPUT THE DATA

# To convert into lists: https://capitalizemytitle.com/tools/column-to-comma-separated-list/

# (1) Enter attitudes towards changes (specifically, increases) in the high and low signal groups
# To get this from STATA, run (e.g.): browse increase_minwage if minwage_high == 0

increase_low = [0,1,1,1]
increase_high = [0,0,1]

# (2) Enter the ideal points
# The variables: Q46 (min_wage), Q50 (taxes), Q54 (refugees), Q58 (benefits), Q62 (NHS)
# To get this from STATA, run (e.g.): browse Q46 if treatment == 1

ideal_points = [40.00,40.00,45.00]

# (3) Enter beliefs in the high and low signal groups
# To get this, run (e.g.): browse minwage_belief if minwage_high == 0

low_beliefs = [35,45,30,50]
high_beliefs = [60, 40, 40]

# PRELIMINARY CHECKS
print('------------------')
print('PRELIMINARY CHECKS')
print('Share who want an increase in low signal group:')
print(sum(increase_low)/len(increase_low))
print('Share who want an increase in high signal group:')
print(sum(increase_high)/len(increase_high))
print('Average ideal point:')
print(sum(ideal_points)/len(ideal_points))
print('Average belief in low signal group:')
print(sum(low_beliefs)/len(low_beliefs))
print('Average belief in high signal group:')
print(sum(high_beliefs)/len(high_beliefs))

print('------------------')

# ANALYSIS

# First, let's store calculate the actual effect (we always do "Low minus High")

actual_difference = sum(increase_low) / len(increase_low) - sum(increase_high) / len(increase_high)
print(f'Actual effect: {actual_difference}')

# Now, let's calculate the theoretically predicted effect

# Start with the low group:

num_pairs = 0
ideal_exceeds_actual = 0

for belief in low_beliefs:
    for ideal in ideal_points:
        num_pairs += 1
        if ideal > belief:
            ideal_exceeds_actual += 1
predicted_low = ideal_exceeds_actual/num_pairs

# Now do the same for the high group:

num_pairs = 0
ideal_exceeds_actual = 0

for belief in high_beliefs:
    for ideal in ideal_points:
        num_pairs += 1
        if ideal > belief:
            ideal_exceeds_actual += 1
predicted_high = ideal_exceeds_actual/num_pairs

# This yields the predicted difference and thus DiD:

predicted_difference = predicted_low - predicted_high

print(f'Predicted difference: {predicted_difference}')

did = predicted_difference - actual_difference

print(f'Difference in difference: {did}')
